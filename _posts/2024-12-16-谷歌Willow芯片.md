---
layout: post
title: 谷歌Willow芯片，quantum error correction below the surface code threshold
katex: True
tags: 量子计算机
---

# 谷歌Willow芯片，quantum error correction below the surface code threshold

最近，谷歌在nature发表的论文“quantum error correction below the surface code threshold”刷屏了各大媒体，引发一阵量子计算的热潮，谷歌股价也受到消息刺激，几天大涨超10%。尽管目前并无实际用途，但其实现的纠错能力是领域的一个重大突破。论文作者均来自Google Quantum AI团队，本篇博客对该论文内容做简要介绍，并对一些相关的概念做记录，以备后用。

## 论文内容
该论文的核心内容包括四部分，分别如下：

### I. 低于阈值的表面码内存 (A Surface Code Memory Below Threshold)

该部分描述了使用最新的Willow处理器实现了两个低于阈值的表面码内存：距离为7的代码和集成了实时解码器的距离为5的代码。这里低于阈值指的即是低于某个特定的临界值，使得逻辑量子比特的错误率能够随着编码复杂度（如代码距离d）的增加而指数级下降。临界值也被称为阈值错误率（threshold error rate），它是量子纠错理论中的一个重要概念。研究人员使用Willow架构的105-qubit处理器实现了距离为7的表面码和集成实时解码器的距离为5的代码。该量子芯片展示了卓越的逻辑错误率抑制水平。实验显示距离为7的代码每周期逻辑错误率为0.143% ± 0.003%，其寿命超过最佳物理量子比特的2.4倍。通过增加代码距离，逻辑错误率呈指数级下降，误差抑制因子 \(\Lambda = 2.14 \pm 0.02\)（神经网络解码器）。检测概率随代码距离增加而略有上升，归因于有限尺寸效应和寄生耦合。研究团队还进行了物理错误注入实验，验证了幂律关系，并发现了不同代码距离曲线在约20%检测概率处交叉。详细的误差预算分析揭示了CZ门操作中的杂散相互作用和泄漏是主要错误来源。此外，数据量子比特泄漏移除显著提升了代码性能，强调了有效处理泄漏的重要性。长时间稳定性测试显示，表面码能够在数小时的时间尺度上保持稳定，表明其适合执行大规模容错量子算法。

### III. 逻辑错误敏感性 (Logical Error Sensitivity)

该部分主要探讨了表面码（surface codes）对不同错误机制的敏感性。这部分工作旨在理解逻辑错误如何随物理错误和代码距离变化，并识别影响纠错性能的关键因素。

在实验上，通过向数据量子比特和测量量子比特注入可控的相干错误，模拟不同强度的物理错误。每次实验包含10个周期，每个周期执行2 × 10^4次重复实验以确保统计显著性。评估上使用检测概率（detection probability）作为物理错误率的代理指标，并评估逻辑性能。

#### 主要结果

1. **幂律关系**：当检测概率低于交叉点（约20%）时，逻辑错误率随检测概率的变化符合 \((d+1)/2\) 的幂律关系，表明随着代码距离 \(d\) 的增加，逻辑错误率呈指数级下降。然而，实际观测到的误差抑制因子略低于理想值，研究人员认为这是由于设备中存在的额外相关错误所致。

2. **交叉点分析**：不同代码距离（\(d=3, 5, 7\)）的曲线在检测概率约为20%处交叉，标志着从亚阈值到超阈值行为的转变，这与理论预测一致。

3. **误差分析**：结果显示，局部和相关错误（如CZ门操作中的杂散相互作用和泄漏）是错误的主要贡献，占据了总误差预算的大约17%。尽管误差预算能够解释大部分性能差异，但仍有约14%的过预测误差，表明存在未完全理解和建模的长程相互作用或高能泄漏。

4. **泄漏处理的重要性**：激活数据量子比特泄漏移除（DQLR）显著提升了距离为5的代码性能，使误差抑制因子 \(\Lambda\) 提高了35%，而距离为3的代码性能提升较小。这强调了有效处理泄漏对于实现高效表面码纠错的重要性。

5. **漂移稳定性测试**：为了评估表面码在长时间运行中的稳定性，研究人员进行了多次重复实验，覆盖长达15小时的时间跨度。尽管某些距离为3的象限表现出了较大的性能波动，但在距离为5的代码中，这种波动被显著抑制。频率优化策略和重新校准处理器的方法显示逻辑量子比特对现有水平的漂移具有较强的鲁棒性。

总的来说，相关错误（如泄漏和杂散相互作用）对逻辑错误率有显著影响。继续改进量子比特的相干时间和操作保真度，开发更高效的解码算法，特别是那些能够更好地处理相关错误的算法，以及采用更多有效的泄漏移除技术，都是未来改进的方向。此外，确保量子处理器在长时间尺度上保持稳定，识别新的错误机制，将有助于构建更加可靠的量子计算机。

### III. 超低错误率下的重复码内存 (A Repetition Code Memory in the Ultra-Low Error Regime)
远距离重复码是发现新错误机制的重要工具，研究团队探讨了远距离重复码（repetition codes）的纠错能力。使用72-qubit Willow处理器，实施了距离为29的重复码，包括比特翻转码和相位翻转码两种类型。实验运行了1000次纠错循环，总计 \(2 \times 10^{10}\) 次纠错循环，涵盖了大量统计样本，平均每个循环逻辑错误率约为$\epsilon_{d}=\frac{1}{2}(1-(1-2p_{L})^{1/1000})$。结果显示，在距离为29的重复码中，每周期逻辑错误率显著低于 \(10^{-6}\)，突破了之前的水平。然而，在距离大于等于15时，观察到了偏离exponential error suppression（指数错误抑制？不太明白）的现象，导致约 \(10^{-10}\) 的逻辑错误率下限。这一罕见的相关错误事件大约每小时发生一次，表现为多个检测器同时经历较大的检测概率激增，并以约369微秒的时间常数衰减。这些事件具有空间局部性，影响大约30个量子比特的邻域。作者认为改进后的约瑟夫森结间隙工程有助于减轻高能量冲击事件的影响，但仍需进一步研究这些罕见但严重的问题。


### IV. 实时解码 (Real-Time Decoding)


“实时解码”部分，研究团队展示了如何在严格的实时要求下实现高效的量子纠错解码。这一部分的工作旨在确保即使在快速的超导量子处理器上，也能保持低于阈值的性能，同时仅略微降低准确性。


#### 主要结果

1. **解码延迟**：
   - 研究人员测试了不同实验持续时间下的解码延迟，结果显示平均解码延迟约为63±17微秒，且不受实验长度（最多1.1秒）的影响。这表明解码问题能够在实时条件下有效处理。


2. **准确性和比较**：
   - 将实时解码器与高精度离线解码器（如神经网络解码器和集合匹配合成解码器）进行了对比。对于距离为5的表面码，实时解码器实现了 \(ε_5 = 0.35\% \pm 0.01\%\) 和 \(\Lambda = 2.0 \pm 0.1\) 的性能，而离线神经网络解码器则达到了 \(ε_5 = 0.269\% \pm 0.008\%\) 和 \(\Lambda = 2.18 \pm 0.09\)。尽管实时解码器的准确性略低，但其速度优势使其适用于实际应用。

3. **资源效率**：
   - 实时解码器不仅保持了低于阈值的性能，还展示了良好的资源效率。研究人员指出，进一步优化解码算法（如引入分层或窗口解码技术）可以提升实时解码的精度，使之更接近离线解码器的表现。


实时解码的关键挑战在于随着代码规模扩大，解码问题的复杂性呈指数级上升，这对计算资源要求较高。未来的研究将集中在开发更高效的解码算法和技术，以应对大规模容错量子计算的需求。例如，通过分布式计算、硬件加速（如FPGA）和模块化解码方法，可以进一步提高解码的速度和精度。

### 初步结论
总的来说，新的Willow架构中实现了低于阈值的表面码内存，每次代码距离增加两次时，每周期的逻辑错误率减少一半以上，最终使得距离为7的逻辑量子比特寿命超过了其最佳组成物理量子比特寿命两倍以上。此外，该芯片也展示了其他关键进展，如数小时内的可重复性能和长达百万次循环的稳定表现，这些都是未来大规模容错算法所必需的。至于媒体中大力鼓吹吸引眼球的：`世界上最快超算Frontier要完成同样任务，则需要10亿亿亿年，也就是10,000,000,000,000,000,000,000,000年。`，并没有任何实际意义。简单来说，该任务为随机线路采样，是专为门电路量子计算设计的任务，采用量子计算机进行模拟具有天然的优势，相当于自定义比赛项目以及标准。

## 相关概念：代码距离
代码距离 \(d\)（code distance）是量子纠错码中的一个重要参数，决定了编码能够检测和纠正错误的能力。简单来说，是指在一个量子纠错码中，至少需要同时发生多少个独立的错误才能导致逻辑信息的丢失或改变。换句话说，它是能够被该编码方案检测到的最小错误数量。

- **对于表面码**：代码距离 \(d\) 定义为在不引起逻辑错误的情况下，可以容忍的最大错误链长度。例如，在一个距离为7的表面码中，任何不超过3个非相关错误都可以被纠正。
- **对于重复码**：代码距离 \(d\) 表示逻辑量子比特的状态被复制到 \(d\) 个物理量子比特上，因此可以检测并纠正最多 \(\left\lfloor \frac{d-1}{2} \right\rfloor\) 个翻转错误。


在实际的量子系统中，错误通常以两种形式出现：
- **比特翻转错误（bit-flip errors）**：类似于经典计算中的位反转。
- **相位翻转错误（phase-flip errors）**：仅影响量子态的相对相位而不改变其概率幅值。

这些错误可能是由于环境噪声、操作失误或其他因素引起的。量子纠错码的设计目标就是在存在这些错误的情况下保护量子信息。当多个错误同时发生时，它们可能会相互作用形成“错误链”。如果这些错误链足够长，就可能跨越整个编码结构，从而导致逻辑量子比特的状态发生变化。代码距离 \(d\) 确定了这样一个临界长度——即超过 \(d/2\) 的错误链才会对逻辑信息造成不可逆的影响。

较高的代码距离意味着更强的容错能力，因为更多的独立错误必须同时发生才能破坏逻辑信息。这增加了系统的鲁棒性，

**实现方式**

- **表面码**：使用二维网格布局，其中数据量子比特位于顶点位置，测量量子比特位于面中心。稳定子测量用于监测局部区域内的错误，并通过解码器来确定最佳修正策略。
- **重复码**：在一维链上重复同一个量子态，利用多数投票机制来识别和修复单个量子比特的翻转错误。


## 相关概念：纠错码
论文中，表面码内存（Surface Code Memory）和重复码内存（Repetition Code Memory）是两种不同的量子纠错编码方案，它们用于保护量子信息免受错误的影响。这里简单介绍这两种内存及其工作原理。

### 表面码内存 (Surface Code Memory)

**表面码**之所以命名为表面，因为其是一种二维拓扑量子纠错码，它利用了量子比特之间的局部相互作用来检测并纠正错误。表面码的一个重要特性是其具有高容错能力，能够容忍一定比例的物理量子比特错误而不影响逻辑量子比特的状态。表面码的性能可以通过增加代码距离（code distance, \(d\)）来提升，\(d\)越大，逻辑错误率越低。

#### 工作原理：
- **数据量子比特与测量量子比特**：表面码由两类量子比特组成——数据量子比特（data qubits）和测量量子比特（measurement qubits）。数据量子比特存储实际的量子信息，而测量量子比特用于检测错误。
- **稳定子测量**：通过执行一系列的稳定子测量（stabilizer measurements），可以获取关于是否存在错误的信息。稳定子测量的结果称为“综合症”（syndrome），它们不会泄露逻辑量子比特的具体状态，但可以指示出哪里可能发生了错误。
- **解码器**：根据综合症信息，解码器会计算出最有可能发生错误的位置，并应用相应的修正操作。解码器可以是离线的或实时的，取决于应用场景的需求。

### 重复码内存 (Repetition Code Memory)

**重复码**是一种简单的量子纠错码，主要用于一维链上的量子比特。它通过冗余地编码量子信息来检测和纠正单个量子比特的翻转错误（bit-flip errors）或相位翻转错误（phase-flip errors）。重复码的基本思想是在多个量子比特上重复同一量子态，从而允许检测到单个量子比特的变化。

#### 工作原理：
- **编码**：对于一个逻辑量子比特，使用多个物理量子比特进行编码。例如，在一个距离为\(d\)的重复码中，逻辑量子比特的状态会被复制到\(d\)个物理量子比特上。
- **错误检测**：通过比较相邻的量子比特状态，可以检测到单个量子比特是否发生了翻转。如果发现不一致，则表明其中一个量子比特可能出错了。
- **错误纠正**：一旦检测到错误，可以根据多数原则决定正确的状态，并将所有量子比特恢复到该状态。


### 总结

- **表面码内存**：适用于二维网格结构，能够高效地检测和纠正多种类型的错误，特别是那些发生在邻近量子比特之间的错误。它依赖于复杂的解码算法，并且随着代码距离的增加，逻辑错误率呈指数级下降。
- **重复码内存**：虽然结构简单，但在检测和纠正单个量子比特翻转方面非常有效。它更适合研究特定类型的错误机制，并且可以在更高的代码距离下探索新的错误源。



## 相关背景：超导量子计算中的噪声
在量子计算中，噪声是影响量子比特性能和量子算法准确性的主要因素之一。常见的噪声类型包括T1弛豫时间、T2退相时间、门操作误差和读出误差。

### 1. T1弛豫时间（T1 Relaxation Time）

**定义**：T1弛豫时间是指量子比特从激发态（|1⟩）衰减到基态（|0⟩）的平均时间。它描述了量子比特的能量耗散过程。

**影响**：
- **能量泄漏**：T1弛豫会导致量子比特的状态从|1⟩自发地跃迁到|0⟩，从而导致信息丢失。
- **错误累积**：长时间的操作会增加由于T1弛豫引起的错误概率。

**示例**：如果一个量子比特的T1时间为50微秒，那么在50微秒内，该量子比特从|1⟩状态衰减到|0⟩状态的概率约为63%。

### 2. T2退相时间（T2 Dephasing Time）

**定义**：T2退相时间是指量子比特相干性丧失的时间尺度。它描述了量子比特的相位信息如何随时间而丢失。

**影响**：
- **相位失真**：T2退相会导致量子比特的相位信息逐渐丢失，从而使叠加态变得不纯。
- **相干性降低**：T2退相时间短会显著降低量子算法的性能，因为许多量子算法依赖于量子比特之间的相干性。

**关系**：T2退相时间通常分为两种类型：
- **T2*（T2星）**：考虑了所有可能的退相干源，包括T1弛豫和其他环境噪声。
- **T2**：仅考虑除T1弛豫外的退相干源。

**示例**：如果一个量子比特的T2时间为100微秒，那么在100微秒内，该量子比特的相位信息会显著丢失。

### 3. 门操作误差（Gate Errors）

**定义**：门操作误差是指量子门操作过程中引入的误差。这些误差可以由多种因素引起，如控制脉冲的不精确、量子比特间的耦合以及环境噪声等。

**影响**：
- **状态失真**：门操作误差会导致量子比特的状态偏离预期的目标状态。
- **累积效应**：多次门操作后，误差会累积，从而显著降低量子算法的准确性。

**示例**：假设一个单量子比特门的误差率为1%，那么经过100次门操作后，累积误差可能会达到不可接受的程度。

### 4. 读出误差（Readout Error）

**定义**：读出误差是指在测量量子比特状态时引入的误差。这些误差可以由测量设备的不精确或量子比特与环境的相互作用引起。

**影响**：
- **误判**：读出误差会导致量子比特的状态被错误地识别。例如，将|0⟩误判为|1⟩或将|1⟩误判为|0⟩。
- **结果失真**：读出误差会影响量子算法的最终结果，尤其是在需要多次测量的情况下。

**示例**：假设一个量子比特的读出误差率为5%，那么在测量100个量子比特时，大约有5个量子比特的状态会被错误地识别。

### 简单总结

- **T1弛豫时间**：描述量子比特从激发态到基态的衰减过程。
- **T2退相时间**：描述量子比特相位信息的丧失过程。
- **门操作误差**：描述量子门操作过程中引入的误差。
- **读出误差**：描述在测量量子比特状态时引入的误差。

除了T1弛豫时间、T2退相时间、门操作误差和读出误差之外，还存在其他几种噪声类型。这些噪声类型同样会影响量子比特的性能和量子算法的准确性，主要包括：

### 1. **相干性损失（Coherent Errors）**

**定义**：相干性损失是指由于控制脉冲不精确或系统参数偏差导致的系统性误差。这些误差是确定性的，并且在多次实验中会以相同的方式出现。

**影响**：
- **状态失真**：相干性损失会导致量子态偏离预期的目标状态。
- **累积效应**：多次操作后，这些误差会累积，从而显著降低量子算法的准确性。

如果控制脉冲的幅度或时长有微小偏差，可能会导致量子门操作偏离理想状态。

### 2. **非相干性损失（Incoherent Errors）**

**定义**：非相干性损失是指由环境噪声引起的随机误差。这些误差是随机的，并且在每次实验中都可能不同。

**影响**：
- **状态混合**：非相干性损失会导致量子态变得不纯，即量子态的概率分布发生变化。
- **信息丢失**：非相干性损失会导致量子信息的部分或全部丢失。
  
环境中的热噪声或电磁干扰可能会导致量子比特的状态发生随机变化。

### 3. **串扰（Crosstalk）**

**定义**：串扰是指一个量子比特的操作对其他量子比特的影响。这种影响通常是由于量子比特之间的耦合或控制线路的交叉干扰引起的。

**影响**：
- **状态失真**：串扰会导致相邻量子比特的状态受到干扰，从而偏离预期的状态。
- **错误传播**：串扰可能会导致错误从一个量子比特传播到另一个量子比特，从而增加整体的错误率。

在一个多量子比特系统中，对一个量子比特施加的控制脉冲可能会意外地影响到附近的量子比特。

### 4. **频率漂移（Frequency Drift）**

**定义**：频率漂移是指量子比特的共振频率随时间的变化。这种变化可能是由于温度波动、磁场变化或其他环境因素引起的。

**影响**：
- **控制精度下降**：频率漂移会导致控制脉冲不再精确匹配量子比特的共振频率，从而降低控制精度。
- **操作失败**：频率漂移可能导致某些量子门操作失败或效果不佳。

量子比特的共振频率可能会因为环境温度的变化而发生微小偏移，从而影响控制脉冲的效果。

### 5. **耦合强度变化（Coupling Strength Fluctuations）**

量子比特间的耦合强度变化是指量子比特之间相互作用的强度随时间的变化。这种变化可能是由于环境噪声或硬件不稳定性引起的。

**影响**：
- **操作精度下降**：耦合强度的变化会导致量子比特间的相互作用强度不稳定，从而影响多量子比特门操作的精度。
- **错误累积**：耦合强度的变化可能会导致错误累积，特别是在需要精确控制多个量子比特的情况下。

在超导量子比特中，量子比特间的耦合强度可能会因为微波控制线的波动而发生变化。

### 6. **频率失谐（Detuning）**

**定义**：量子比特频率的失谐是指量子比特的实际频率与其设计频率之间的差异。这种失谐可能是由于制造过程中的偏差或环境因素引起的。

**影响**：
- **控制精度下降**：频率失谐会导致控制脉冲不再精确匹配量子比特的共振频率，从而降低控制精度。
- **操作失败**：频率失谐可能导致某些量子门操作失败或效果不佳。

在实际的量子处理器中，量子比特的频率可能会因为制造过程中的微小偏差而与设计值有所不同。

## 参考资料
 1. https://www.nature.com/articles/s41586-024-08449-y
 2. https://blog.google/technology/research/google-willow-quantum-chip/
 3. https://research.google/blog/making-quantum-error-correction-work/